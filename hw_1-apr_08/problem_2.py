from __future__ import division

import matplotlib.pyplot as plt

errors_half = [
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161,
   0.559773594776161
]

errors_1 = [
   0.587263375566963,
   0.253217755204673,
   0.224915830880838,
   0.220528661826066,
   0.219653452275484,
   0.219452788622650,
   0.219402544231552,
   0.219389175999081,
   0.219385457973349,
   0.219384388394818,
   0.219384072426105,
   0.219383977063662,
   0.219383947770250,
   0.219383938638014,
   0.219383935755086,
   0.219383934835111,
   0.219383934538771,
   0.219383934442526,
   0.219383934411041,
   0.219383934400673,
   0.219383934397240,
   0.219383934396097,
   0.219383934395714,
   0.219383934395586,
   0.219383934395543,
   0.219383934395528,
   0.219383934395523,
   0.219383934395521,
   0.219383934395521,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520,
   0.219383934395520
]

errors_2 = [
   0.318978930463381,
   0.031983600303485,
   0.047056545212955,
   0.048614328850425,
   0.048846607132068,
   0.048889035003540,
   0.048897852160057,
   0.048899855507616,
   0.048900341421636,
   0.048900465308131,
   0.048900498159826,
   0.048900507152383,
   0.048900509679236,
   0.048900510405026,
   0.048900510617423,
   0.048900510680587,
   0.048900510699635,
   0.048900510705450,
   0.048900510707244,
   0.048900510707803,
   0.048900510707979,
   0.048900510708035,
   0.048900510708053,
   0.048900510708058,
   0.048900510708060,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061,
   0.048900510708061
]

errors_3 = [
   1.852445586951409,
   0.055340657105639,
   0.016121656919374,
   0.013406108416243,
   0.013102284670190,
   0.013057944181299,
   0.013050280057058,
   0.013048790594475,
   0.013048475142211,
   0.013048403794162,
   0.013048386797940,
   0.013048382575730,
   0.013048381489899,
   0.013048381202424,
   0.013048381124410,
   0.013048381102783,
   0.013048381096676,
   0.013048381094923,
   0.013048381094412,
   0.013048381094262,
   0.013048381094217,
   0.013048381094203,
   0.013048381094199,
   0.013048381094198,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197,
   0.013048381094197
]

errors_5 = [
  37.156971853906953,
   0.214724289449055,
   0.008046092443339,
   0.001599926335358,
   0.001191849680677,
   0.001153661545704,
   0.001149078429026,
   0.001148424839801,
   0.001148319045225,
   0.001148300176668,
   0.001148296543470,
   0.001148295799101,
   0.001148295638572,
   0.001148295602429,
   0.001148295593988,
   0.001148295591953,
   0.001148295591449,
   0.001148295591321,
   0.001148295591287,
   0.001148295591279,
   0.001148295591276,
   0.001148295591276,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275,
   0.001148295591275
]

errors_8 = [
   1.0e+04*1.320650402094799,
   1.0e+04*0.000948902743772,
   1.0e+04*0.000009076688487,
   1.0e+04*0.000000247054788,
   1.0e+04*0.000000008617978,
   1.0e+04*0.000000002883575,
   1.0e+04*0.000000003685440,
   1.0e+04*0.000000003757590,
   1.0e+04*0.000000003765419,
   1.0e+04*0.000000003766399,
   1.0e+04*0.000000003766537,
   1.0e+04*0.000000003766558,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562,
   1.0e+04*0.000000003766562
]

errors_10 = [
   1.0e+06*1.214671328565094,
   1.0e+06*0.000218189746605,
   1.0e+06*0.000000927970284,
   1.0e+06*0.000000014414189,
   1.0e+06*0.000000000451471,
   1.0e+06*0.000000000018402,
   1.0e+06*0.000000000002634,
   1.0e+06*0.000000000004028,
   1.0e+06*0.000000000004144,
   1.0e+06*0.000000000004155,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157,
   1.0e+06*0.000000000004157
]

n = []
for i in xrange(1,41):
    n.append(i)

plt.figure()
plt.yscale('log')
plt.title(r'Error of the Asymptotic Expansion for different values of $x$')
plt.xlabel(r"$n$", size=20)
plt.ylabel("Error", size=20)
plt.plot(n, errors_half, label=r"$x = 1/2$")
plt.plot(n, errors_1, label=r"$x = 1$")
plt.plot(n, errors_2, label=r"$x = 2$")
plt.plot(n, errors_3, label=r"$x = 3$")
plt.plot(n, errors_5, label=r"$x = 5$")
plt.plot(n, errors_8, label=r"$x = 8$")
plt.plot(n, errors_10, label=r"$x = 10$")
plt.legend(loc=0)
plt.savefig("problem_2.png", type="png", dpi=300)

